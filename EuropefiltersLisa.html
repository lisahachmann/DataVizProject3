<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Social Media Data Charts</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">
    </head>
<body>
    <h1></h1>
    <div>
        <svg id ="viz" height="500" width="800" style="border: 1px solid grey"></svg>
    </div>

    <div class="btn-group" role="group">
      <button type="button" class="btn btn-default country" id="Britain">Britain</button>
      <button type="button" class="btn btn-default country" id="France">France</button>
      <button type="button" class="btn btn-default country" id="Germany">Germany</button>
      <button type="button" class="btn btn-default country" id="Italy">Italy</button>
      <button type="button" class="btn btn-default country" id="Spain">Spain</button>
      <button type="button" class="btn btn-default country" id="Greece">Greece</button>
      <button type="button" class="btn btn-default country" id="Poland" >Poland</button>
      <button type="button" class="btn btn-default country" id="Czech Republic">Czech Republic</button>
    </div>

    <div class ="btn-group" role="group">
      <button type="button" class="btn btn-default observation" id="Trustworthiness">Trustworthiness</button>
      <button type="button" class="btn btn-default observation" id="Arrogant">
      Arrogant
      </button>
      <button type="button" class="btn btn-default observation" id="Compassionate">Compassionate</button>
    </div>


    </div>

<script type="text/javascript">
    var GLOBAL = {data: [], country_button: null, observation_button: null, big_countries:["Britain", "France", "Germany", "Italy", "Spain", "Greece, Poland", "Czech Republic"]};
    function computeSizes (svg) {
    // get the size of the SVG element
    var height = svg.attr("height");
    var width = svg.attr("width");
    var margin = 10;
    // the chart lives in the svg surrounded by a margin of 100px
    return { height:height,
	    width: width,
	    margin: margin,
	    chartHeight: height-2*margin,
	    chartWidth: width-2*margin}
}
        window.addEventListener("load", run);

        function run () {

        d3.csv("EuropeanUnionfeelings.csv", function(data) {
        GLOBAL.data = data;
        });

        d3.selectAll("button").on("click", function(){

        var j = countbyColumn(this.id);
        console.log(j)});
        }

function countbyColumn(country){
    var observation = 'Arrogance';
    var counts = {};
    var bigresponses0 = {};
    var bigresponses1 = {};
     GLOBAL.data.forEach(function(r) {
         if (r["COUNTRY"] == country){
            if (r["COUNTRY"] in counts){
                counts[r["COUNTRY"]] +=1;
                if(r[observation+"0"] in bigresponses0){
                    bigresponses0[r[observation+"0"]] +=1;
                }
                else {
                    bigresponses0[r[observation+"0"]] =1;
                }
                if(r[observation+"1"] in bigresponses1){
                    bigresponses1[r[observation+"1"]] +=1;
                }
                else{
                    bigresponses1[r[observation+"1"]] =1;
                }
            }
            else{
                counts[r["COUNTRY"]] = 1;
            }
        }
    })

return {bigresponses0,bigresponses1};
}

</script>
</body>
</html>
